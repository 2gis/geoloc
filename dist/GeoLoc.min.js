!function(e){function t(t,n,i){function r(){if(!g){g=!0,v.onload=v.onreadystatechange=v.onerror=null,clearTimeout(h);try{delete window[a]}catch(t){window[a]=e}v.parentNode.removeChild(v)}}i?n||(n={}):(i=n,n={});var u=n.callbackKey||"callback",a=n.callbackName||"__callback"+ ++o,l=n.preventCaching!==!1,d=n.cachingPreventionKey||"noCache",c=n.timeout||12e4,s=!1,m=!1,p=!1,f=!1,g=!1,v=document.createElement("script");v.src=t+(-1==t.indexOf("?")?"?":"&")+u+"="+a+(l?"&"+d+"="+Math.random():""),v.async=!0,v.onload=v.onreadystatechange=function(){v.readyState&&"complete"!=v.readyState&&"loaded"!=v.readyState||p||(p=!0,setTimeout(function(){f||(r(),s||m||i(new Error("Invalid response or loading error"),null))},1))},v.onerror=function(){f||(r(),s||m||i(new Error("Script error"),null))};var h=setTimeout(function(){m||(s=!0,i(new Error("Timeout error"),null))},c);return window[a]=function(e){r(),s||m||(f=!0,i(null,e))},(document.head||document.documentElement).appendChild(v),{abort:function(){m=!0}}}var o=0;window.jsonpRequest={send:t}}(),function(){"use strict";function e(e){e||(e={}),e.providerTimeout&&(this.providerTimeout=e.providerTimeout),e.maximumAge&&(this.maximumAge=e.maximumAge),this.providers=e.providers||n}var t="undefined"==typeof window?t:window,o=0,n=[];e.providers={},e.setDefaultProviders=function(t){return n=t,e},e.use=function(t){return new e({providers:t})},e.getPosition=function(t,o){return(new e).getPosition(t,o)},e.prototype={constructor:e,providerTimeout:1e4,maximumAge:864e5,providers:null,use:function(e){return this.providers=e,this},_getPositionFromLocalStorage:function(e){var t=localStorage.getItem("_GeoLocData");if(t){t=t.split(",");var o=Number(t[2]);if(Date.now()-o<=e)return{latitude:Number(t[0]),longitude:Number(t[1])}}return null},getPositionParallel:function(e,t){function n(){for(var e in d)d[e].abort(),delete d[e]}function i(){for(var e in d)return!0;return!1}function r(e){var r=e.getPosition(function(e,o){delete d[r._GeoLoc_id],e?i()||t(e,null):"number"!=typeof o.latitude||"number"!=typeof o.longitude?i()||t(new TypeError("Incorrect data"),null):(n(),localStorage.setItem("_GeoLocData",[o.latitude,o.longitude,Date.now()].join(",")),t(null,o))},{timeout:a});r._GeoLoc_id=++o,d[r._GeoLoc_id]=r}"function"==typeof e&&(t=e,e={});var u=this._getPositionFromLocalStorage(e.maximumAge||this.maximumAge);if(u)return t(null,u),this;for(var a=e.providerTimeout||this.providerTimeout,l=e.providers||this.providers,d={},c=0,s=l.length;s>c;c++)r(l[c]);return this},getPosition:function(e,t){"function"==typeof e&&(t=e,e={});var o=this._getPositionFromLocalStorage(e.maximumAge||this.maximumAge);if(o)return t(null,o),this;{var n=e.providerTimeout||this.providerTimeout;e.providers||this.providers}return function i(e){var o=e.shift();o.getPosition(function(o,n){o?e.length?i(e):t(o,null):"number"!=typeof n.latitude||"number"!=typeof n.longitude?e.length?i(e):t(new TypeError("Incorrect data"),null):(localStorage.setItem("_GeoLocData",[n.latitude,n.longitude,Date.now()].join(",")),t(null,n))},{timeout:n})}(this.providers.slice(0)),this}},"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports?module.exports=e:exports.GeoLoc=e:t.GeoLoc=e,e.providers.freegeoip_net={getPosition:function(e,t){return jsonpRequest.send("http://freegeoip.net/json/",t&&{timeout:t.timeout},function(t,o){e(t,o&&{latitude:o.latitude,longitude:o.longitude})})}},e.providers.telize_com={getPosition:function(e,t){return jsonpRequest.send("http://www.telize.com/geoip/",t&&{timeout:t.timeout},function(t,o){e(t,o&&{latitude:o.latitude,longitude:o.longitude})})}},e.providers.html5geolocation={getPosition:function(e){return navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){e(null,{latitude:t.coords.latitude,longitude:t.coords.longitude})},function(t){e(t,null)}):e(new TypeError("HTML5 Geolocation not supported"),null),{abort:function(){}}}},e.setDefaultProviders([e.providers.freegeoip_net,e.providers.telize_com,e.providers.html5geolocation])}();