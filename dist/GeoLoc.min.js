!function(){function e(e,o,n){function i(){f||(f=!0,g.onload=g.onreadystatechange=g.onerror=null,clearTimeout(v),delete window[u],g.parentNode.removeChild(g))}n?o||(o={}):(n=o,o={});var r=o.callbackKey||"callback",u=o.callbackName||"__callback"+ ++t,a=o.preventCaching!==!1,l=o.cachingPreventionKey||"noCache",d=o.timeout||12e4,c=!1,s=!1,m=!1,p=!1,f=!1,g=document.createElement("script");g.src=e+(-1==e.indexOf("?")?"?":"&")+r+"="+u+(a?"&"+l+"="+Math.random():""),g.async=!0,g.onload=g.onreadystatechange=function(){g.readyState&&"complete"!=g.readyState&&"loaded"!=g.readyState||m||(m=!0,setTimeout(function(){p||(i(),c||s||n(new Error("Invalid response or loading error"),null))},1))},g.onerror=function(){p||(i(),c||s||n(new Error("Script error"),null))};var v=setTimeout(function(){s||(c=!0,n(new Error("Timeout error"),null))},d);return window[u]=function(e){i(),c||s||(p=!0,n(null,e))},(document.head||document.documentElement).appendChild(g),{abort:function(){s=!0}}}var t=0;window.jsonpRequest={send:e}}(),function(){"use strict";function e(e){e||(e={}),e.providerTimeout&&(this.providerTimeout=e.providerTimeout),e.maximumAge&&(this.maximumAge=e.maximumAge),this.providers=e.providers||n}var t="undefined"==typeof window?t:window,o=0,n=[];e.providers={},e.setDefaultProviders=function(t){return n=t,e},e.use=function(t){return new e({providers:t})},e.getPosition=function(t,o){return(new e).getPosition(t,o)},e.prototype={constructor:e,providerTimeout:1e4,maximumAge:864e5,providers:null,use:function(e){return this.providers=e,this},_getPositionFromLocalStorage:function(e){var t=localStorage.getItem("_GeoLocData");if(t){t=t.split(",");var o=Number(t[2]);if(Date.now()-o<=e)return{latitude:Number(t[0]),longitude:Number(t[1])}}return null},getPositionParallel:function(e,t){function n(){for(var e in l)l[e].abort(),delete l[e]}function i(){for(var e in l)return!0;return!1}"function"==typeof e&&(t=e,e={});var r=this._getPositionFromLocalStorage(e.maximumAge||this.maximumAge);if(r)return t(null,r),this;var u=e.providerTimeout||this.providerTimeout,a=e.providers||this.providers,l={};return a.forEach(function(e){var r=e.getPosition(function(e,o){delete l[r._GeoLoc_id],e?i()||t(e,null):"number"!=typeof o.latitude||"number"!=typeof o.longitude?i()||t(new TypeError("Incorrect data"),null):(n(),localStorage.setItem("_GeoLocData",[o.latitude,o.longitude,Date.now()].join(",")),t(null,o))},{timeout:u});r._GeoLoc_id=++o,l[r._GeoLoc_id]=r},this),this},getPosition:function(e,t){"function"==typeof e&&(t=e,e={});var o=this._getPositionFromLocalStorage(e.maximumAge||this.maximumAge);if(o)return t(null,o),this;{var n=e.providerTimeout||this.providerTimeout;e.providers||this.providers}return function i(e){var o=e.shift();o.getPosition(function(o,n){o?e.length?i(e):t(o,null):"number"!=typeof n.latitude||"number"!=typeof n.longitude?e.length?i(e):t(new TypeError("Incorrect data"),null):(localStorage.setItem("_GeoLocData",[n.latitude,n.longitude,Date.now()].join(",")),t(null,n))},{timeout:n})}(this.providers.slice(0)),this}},"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports?module.exports=e:exports.GeoLoc=e:t.GeoLoc=e,e.providers.freegeoip_net={getPosition:function(e,t){return jsonpRequest.send("http://freegeoip.net/json/",t&&{timeout:t.timeout},function(t,o){e(t,o&&{latitude:o.latitude,longitude:o.longitude})})}},e.providers.telize_com={getPosition:function(e,t){return jsonpRequest.send("http://www.telize.com/geoip/",t&&{timeout:t.timeout},function(t,o){e(t,o&&{latitude:o.latitude,longitude:o.longitude})})}},e.providers.html5geolocation={getPosition:function(e){return navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){e(null,{latitude:t.coords.latitude,longitude:t.coords.longitude})},function(t){e(t,null)}):e(new TypeError("HTML5 Geolocation not supported"),null),{abort:function(){}}}},e.setDefaultProviders([e.providers.freegeoip_net,e.providers.telize_com,e.providers.html5geolocation])}();